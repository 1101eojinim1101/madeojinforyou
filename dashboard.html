<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>학생 대시보드</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      display: flex;
      height: 100vh;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    /* 사이드바 */
    nav {
      width: 180px;
      background: #b3e5fc;
      display: flex;
      flex-direction: column;
    }
    nav a {
      padding: 1rem;
      color: #333;
      text-decoration: none;
      cursor: pointer;
    }
    nav a:hover, nav a.active {
      background: #81d4fa;
    }
    /* 콘텐츠 영역 */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }
    .section {
      display: none;
    }
    .section.active {
      display: block;
    }
    h2 {
      margin-bottom: 1rem;
      color: #333;
    }
    p {
      line-height: 1.5;
    }
  </style>
</head>
<body>

  <!-- 좌측 메뉴 -->
  <nav id="sidebar">
    <a data-target="info"   class="active">나의 정보</a>
    <a data-target="secret">비밀 친구</a>
    <a data-target="learning">배움 정리</a>
    <a data-target="footprint">나의 발자국</a>
    <a data-target="teacher">선생님의 기록</a>
    <a data-target="growth">성장 기록지</a>
  </nav>

  <!-- 우측 콘텐츠 -->
  <div class="content">
    <!-- ====== 나의 정보 섹션 시작 ====== -->
<div id="info" class="section active">
  <h2>나의 정보</h2>
  <!-- 1) 엑셀 업로드 -->
  <input type="file" id="excelFile" accept=".xlsx,.xls" />
  <table id="studentTable" style="width:100%; margin-top:1rem; border-collapse:collapse;">
    <thead>
      <tr style="background:#e1f5fe;">
        <th style="padding:0.5rem; border:1px solid #ccc;">이름</th>
        <th style="padding:0.5rem; border:1px solid #ccc;">학번</th>
        <th style="padding:0.5rem; border:1px solid #ccc;">선택</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- 2) 선택된 학생 정보 폼 -->
  <div id="infoForm" style="display:none; margin-top:2rem; max-width:400px;">
    <h3><span id="selectedName"></span>님의 정보</h3>
    <img id="profilePreview" alt="프로필 사진" style="width:120px; height:120px; border-radius:50%; object-fit:cover; background:#f0f0f0;" />
    <input type="file" id="photoUpload" accept="image/*" style="display:block; margin:0.5rem 0;" />

    <input id="birthday" type="date"     placeholder="생일"                 style="width:100%; padding:0.5rem; margin-bottom:0.5rem;" />
    <input id="mbti"     type="text"     placeholder="MBTI"                style="width:100%; padding:0.5rem; margin-bottom:0.5rem;" />
    <input id="account"  type="text"     placeholder="수학탐험대 계정"        style="width:100%; padding:0.5rem; margin-bottom:0.5rem;" />
    <input id="accountPw"type="text"     placeholder="수학탐험대 비밀번호"    style="width:100%; padding:0.5rem; margin-bottom:0.5rem;" />
    <input id="hobby"    type="text"     placeholder="취미"                style="width:100%; padding:0.5rem; margin-bottom:0.5rem;" />
    <input id="interest" type="text"     placeholder="흥미"                style="width:100%; padding:0.5rem; margin-bottom:0.5rem;" />
    <input id="skill"    type="text"     placeholder="특기"                style="width:100%; padding:0.5rem; margin-bottom:0.5rem;" />
    <input id="dream"    type="text"     placeholder="장래희망"            style="width:100%; padding:0.5rem; margin-bottom:1rem;" />

    <button id="saveInfo" style="padding:0.75rem 1.5rem; background:#64b5f6; color:#fff; border:none; border-radius:6px; cursor:pointer;">
      저장하기
    </button>
  </div>
</div>
<!-- ====== 나의 정보 섹션 끝 ====== -->

<!-- SheetJS for Excel 파싱 -->
<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
<script>
  let selectedId = null;

  // 1) 엑셀 파일 읽어서 테이블에 뿌리기
  document.getElementById('excelFile').addEventListener('change', async e => {
    const file = e.target.files[0];
    if (!file) return;
    const data = await file.arrayBuffer();
    const wb = XLSX.read(data, { type: 'array' });
    const rows = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
    const tbody = document.querySelector('#studentTable tbody');
    tbody.innerHTML = '';
    rows.forEach(r => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td style="padding:0.5rem; border:1px solid #ccc;">${r.이름||''}</td>
        <td style="padding:0.5rem; border:1px solid #ccc;">${r.학번||''}</td>
        <td style="padding:0.5rem; border:1px solid #ccc;">
          <button class="selectBtn" style="padding:0.3rem 0.6rem;">선택</button>
        </td>`;
      tbody.appendChild(tr);
    });
    document.querySelectorAll('.selectBtn').forEach(btn => {
      btn.addEventListener('click', () => {
        const tr = btn.closest('tr');
        const name = tr.children[0].innerText;
        const id   = tr.children[1].innerText;
        selectedId = id;
        document.getElementById('selectedName').innerText = name;
        loadInfo(id);
        document.getElementById('infoForm').style.display = 'block';
      });
    });
  });

  // 2) 저장된 데이터 로드
  function loadInfo(id) {
    const data = JSON.parse(localStorage.getItem('info_' + id) || '{}');
    document.getElementById('profilePreview').src = data.photo || '';
    ['birthday','mbti','account','accountPw','hobby','interest','skill','dream'].forEach(key => {
      document.getElementById(key).value = data[key] || '';
    });
  }

  // 3) 사진 미리보기
  document.getElementById('photoUpload').addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = ev => document.getElementById('profilePreview').src = ev.target.result;
    reader.readAsDataURL(file);
  });

  // 4) 저장하기 (localStorage 사용)
  document.getElementById('saveInfo').addEventListener('click', () => {
    if (!selectedId) return alert('학생을 먼저 선택하세요.');
    const obj = {
      photo: document.getElementById('profilePreview').src,
      birthday: document.getElementById('birthday').value,
      mbti: document.getElementById('mbti').value,
      account: document.getElementById('account').value,
      accountPw: document.getElementById('accountPw').value,
      hobby: document.getElementById('hobby').value,
      interest: document.getElementById('interest').value,
      skill: document.getElementById('skill').value,
      dream: document.getElementById('dream').value,
    };
    localStorage.setItem('info_' + selectedId, JSON.stringify(obj));
    alert('나의 정보가 저장되었습니다.');
  });
</script>

    <div id="secret" class="section">
      <h2>비밀 친구</h2>
      <p>여기에 비밀 친구 관련 내용을 표시합니다.</p>
    </div>
    <div id="learning" class="section">
      <h2>배움 정리</h2>
      <p>여기에 수업별 배움 정리 폼을 넣을 수 있습니다.</p>
    </div>
    <div id="footprint" class="section">
      <h2>나의 발자국</h2>
      <p>여기에 나의 학습 활동 로그나 사진 등이 표시됩니다.</p>
    </div>
    <div id="teacher" class="section">
      <h2>선생님의 기록</h2>
      <p>선생님이 작성한 피드백이나 코멘트를 보여줍니다.</p>
    </div>
    <div id="growth" class="section">
      <h2>성장 기록지</h2>
      <p>분기별 성장 보고서 및 그래프 등을 표시합니다.</p>
    </div>
  </div>

  <script>
    const links = document.querySelectorAll('nav a');
    const sections = document.querySelectorAll('.section');
    links.forEach(link => {
      link.addEventListener('click', () => {
        // 메뉴 active 토글
        links.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
        // 섹션 active 토글
        sections.forEach(s => s.classList.remove('active'));
        document.getElementById(link.dataset.target).classList.add('active');
      });
    });
  </script>

</body>
</html>
