<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>í•™ìƒ ëŒ€ì‹œë³´ë“œ</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      display: flex;
      height: 100vh;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    /* ì‚¬ì´ë“œë°” */
    nav {
      width: 180px;
      background: #b3e5fc;
      display: flex;
      flex-direction: column;
    }
    nav a {
      padding: 1rem;
      color: #333;
      text-decoration: none;
      cursor: pointer;
    }
    nav a:hover, nav a.active {
      background: #81d4fa;
    }
    /* ì½˜í…ì¸  ì˜ì—­ */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }
    .section {
      display: none;
    }
    .section.active {
      display: block;
    }
    h2 {
      margin-bottom: 1rem;
      color: #333;
    }
    p {
      line-height: 1.5;
    }
  </style>
</head>
<body>

  <!-- ì¢Œì¸¡ ë©”ë‰´ -->
  <nav id="sidebar">
    <a data-target="info"   class="active">ë‚˜ì˜ ì •ë³´</a>
    <a data-target="secret">ë¹„ë°€ ì¹œêµ¬</a>
    <a data-target="learning">ë°°ì›€ ì •ë¦¬</a>
    <a data-target="footprint">ë‚˜ì˜ ë°œìêµ­</a>
    <a data-target="teacher">ì„ ìƒë‹˜ì˜ ê¸°ë¡</a>
    <a data-target="growth">ì„±ì¥ ê¸°ë¡ì§€</a>
  </nav>

  <!-- ìš°ì¸¡ ì½˜í…ì¸  -->
   <!-- ====== ë‚˜ì˜ ì •ë³´ ì„¹ì…˜ ì‹œì‘ ====== -->
<div id="info" class="section active">
  <h2>ë‚˜ì˜ ì •ë³´</h2>

  <div id="infoForm" style="margin-top:2rem; max-width:400px;">
    <h3><span id="selectedName"></span>ë‹˜ì˜ ì •ë³´</h3>

    <!-- í”„ë¡œí•„ ì‚¬ì§„ ì—…ë¡œë“œ & ë¯¸ë¦¬ë³´ê¸° -->
    <div class="photo-container">
      <img id="profilePreview" alt="í”„ë¡œí•„ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°" />
      <label for="photoUpload" class="photo-label">í”„ë¡œí•„ ì‚¬ì§„ ì„ íƒ</label>
      <input type="file" id="photoUpload" accept="image/png, image/jpeg" style="display:none" />
    </div>

    <!-- ì •ë³´ ì…ë ¥ë€ -->
    <input id="birthday"  type="date"     style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="mbti"      type="text"     placeholder="MBTI"                  style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="account"   type="text"     placeholder="ìˆ˜í•™íƒí—˜ëŒ€ ê³„ì •"        style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="accountPw" type="text"     placeholder="ìˆ˜í•™íƒí—˜ëŒ€ ë¹„ë°€ë²ˆí˜¸"    style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="hobby"     type="text"     placeholder="ì·¨ë¯¸"                  style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="interest"  type="text"     placeholder="í¥ë¯¸"                  style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="skill"     type="text"     placeholder="íŠ¹ê¸°"                  style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="dream"     type="text"     placeholder="ì¥ë˜í¬ë§"              style="width:100%; margin-bottom:1rem; padding:0.5rem;" />

    <button id="saveInfo" style="width:100%; padding:0.75rem; background:#64b5f6; color:#fff; border:none; border-radius:6px; cursor:pointer;">
      ì €ì¥í•˜ê¸°
    </button>
  </div>
</div>
<!-- ====== ë‚˜ì˜ ì •ë³´ ì„¹ì…˜ ë ====== -->

<style>
  /* í”„ë¡œí•„ ì‚¬ì§„ ì»¨í…Œì´ë„ˆ */
  .photo-container {
    position: relative;
    width: 120px;
    height: 120px;
    margin: 0 auto 1rem;
    border-radius: 50%;
    overflow: hidden;
    background: #f0f0f0;
    border: 1px solid #ccc;
  }
  .photo-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .photo-label {
    display: block;
    text-align: center;
    margin-top: 0.5rem;
    color: #007bff;
    cursor: pointer;
  }
</style>

<script>
  // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œê·¸ì¸ í™•ì¸ ë° ì •ë³´ ë¡œë“œ
  document.addEventListener('DOMContentLoaded', () => {
    const studentId = localStorage.getItem('studentId');
    if (!studentId) return location.href = 'index.html';

    document.getElementById('selectedName').innerText = studentId;
    document.getElementById('infoForm').style.display = 'block';

    const data = JSON.parse(localStorage.getItem('info_' + studentId) || '{}');
    if (data.photo) document.getElementById('profilePreview').src = data.photo;
    ['birthday','mbti','account','accountPw','hobby','interest','skill','dream'].forEach(key => {
      if (data[key]) document.getElementById(key).value = data[key];
    });
  });

  // ì‚¬ì§„ ì—…ë¡œë“œ & ë¯¸ë¦¬ë³´ê¸°
  document.getElementById('photoUpload').addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = ev => document.getElementById('profilePreview').src = ev.target.result;
    reader.readAsDataURL(file);
  });

  // ì •ë³´ ì €ì¥í•˜ê¸°
  document.getElementById('saveInfo').addEventListener('click', () => {
    const studentId = localStorage.getItem('studentId');
    if (!studentId) return alert('ë¡œê·¸ì¸ í›„ ì´ìš©í•˜ì„¸ìš”.');

    const obj = {
      photo: document.getElementById('profilePreview').src,
      birthday: document.getElementById('birthday').value,
      mbti: document.getElementById('mbti').value,
      account: document.getElementById('account').value,
      accountPw: document.getElementById('accountPw').value,
      hobby: document.getElementById('hobby').value,
      interest: document.getElementById('interest').value,
      skill: document.getElementById('skill').value,
      dream: document.getElementById('dream').value,
    };
    localStorage.setItem('info_' + studentId, JSON.stringify(obj));
    alert('ë‚˜ì˜ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
  });
</script>

  <div class="content">

<!-- ====== ë¹„ë°€ ì¹œêµ¬ ì„¹ì…˜ ì‹œì‘ ====== -->
<div id="secret" class="section">
  <!-- ì„œë¸Œíƒ­ -->
  <div class="subtabs">
    <button class="subtab active" data-target="attendance">ê°ì • ì¶œì„ë¶€</button>
    <button class="subtab"       data-target="diary">ì¼ê¸° ì“°ê¸°</button>
  </div>

  <div class="subcontent">
    <!-- ê°ì • ì¶œì„ë¶€ -->
    <div id="attendance" class="subsection active">
      <h3>ê°ì • ì¶œì„ë¶€ â€“ <span id="attDate"></span></h3>
      <div class="emotion-grid"></div>

      <div id="attReason" class="attendance-reason" style="display:none;">
        <input id="reasonInput"
               type="text" maxlength="20"
               placeholder="ë„¤ ë§ˆìŒì˜ ì´ìœ ê°€ ê¶ê¸ˆí•´. ë‚˜ì—ê²Œë§Œ ì•Œë ¤ì¤˜ğŸ¤«"
               style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
        <button id="checkBtn"
                style="padding:0.6em 1.2em;
                       background:#64b5f6; color:#fff;
                       border:none; border-radius:6px;
                       cursor:pointer;">
          ì¶œì„ ì²´í¬
        </button>
      </div>

      <h4 style="margin-top:1.5rem;">ì¶œì„ ê¸°ë¡</h4>
      <ul id="attendanceList"
          style="list-style:none; padding:0; margin-top:0.5rem;">
      </ul>
    </div>

    <!-- ì¼ê¸° ì“°ê¸° -->
    <div id="diary" class="subsection">
      <div class="diary-header"
           style="display:flex;
                  justify-content:space-between;
                  align-items:center;
                  margin-bottom:1rem;">
        <h3>ì¼ê¸° ì“°ê¸°</h3>
        <button id="newDiaryBtn"
                style="padding:0.5rem 1rem;
                       background:#64b5f6; color:#fff;
                       border:none; border-radius:6px;
                       cursor:pointer;">
          ìƒˆ ì¼ê¸° ì“°ê¸°
        </button>
      </div>

      <!-- 1) ì¼ê¸° ëª©ë¡ -->
      <div id="diaryList" class="diary-list"></div>

      <!-- 2) ìƒˆ ì¼ê¸° ì“°ê¸° í¼ -->
      <div id="diaryForm" class="diary-form"
           style="display:none; max-width:500px; margin-bottom:1rem;">
        <input id="diaryDate"
               type="date"
               style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
        <select id="diaryEmotion"
                style="width:100%; margin-bottom:0.5rem; padding:0.5rem;">
        </select>
        <textarea id="diaryText" rows="6"
                  placeholder="ë„¤ ë§ˆìŒê³¼ ê²½í—˜ì„ ì†”ì§í•˜ê²Œ ì¨ë´. ë„ˆë¥¼ í‰ê°€í•˜ê±°ë‚˜ íŒë‹¨í•˜ì§€ ì•Šì„ê²Œ. ì¡°ìš©íˆ ë“£ê³ ìˆë‹¤ê°€, ë„¤ê°€ ì›í•  ë•Œ í•„ìš”í•œ ì¡°ì–¸ì„ í•´ì¤„ê²Œ."
                  style="width:100%; padding:0.5rem; margin-bottom:0.5rem;"></textarea>
        <button id="saveDiaryBtn"
                style="padding:0.6em 1.2em;
                       background:#64b5f6; color:#fff;
                       border:none; border-radius:6px;
                       cursor:pointer;">
          ì €ì¥
        </button>
      </div>

      <!-- 3) ì¼ê¸° ë³´ê¸° -->
      <div id="diaryView" class="diary-view"
           style="display:none; max-width:500px;">
        <button id="backDiaryBtn"
                style="margin-bottom:1rem;
                       padding:0.4rem 0.8rem;
                       background:#aaa; color:#fff;
                       border:none; border-radius:4px;
                       cursor:pointer;">
          ëª©ë¡ìœ¼ë¡œ
        </button>
        <h4>ë‚ ì§œ: <span id="viewDate"></span></h4>
        <p>ê°ì •: <span id="viewEmotion"></span></p>
        <h5>ğŸ“ ì›ë³¸</h5><p id="viewOriginal"></p>
        <h5>ğŸ’¡ AI ì œì•ˆ</h5><p id="viewAI">ì—†ìŒ</p>
        <h5>âœ… ìµœì¢…</h5><p id="viewFinal">ì—†ìŒ</p>
      </div>
    </div>
  </div>
</div>
<!-- ====== ë¹„ë°€ ì¹œêµ¬ ì„¹ì…˜ ë ====== -->

<style>
  .subtabs {
    display: flex; border-bottom:2px solid #ddd; margin-bottom:1rem;
  }
  .subtab {
    flex:1; padding:0.75rem; background:none; border:none;
    border-bottom:3px solid transparent; font-size:1rem; cursor:pointer;
  }
  .subtab.active {
    border-color:#64b5f6; color:#64b5f6;
  }
  .subcontent .subsection { display:none; }
  .subcontent .subsection.active { display:block; }

  .emotion-grid {
    display:grid; grid-template-columns:repeat(5,1fr); gap:0.75rem; margin-bottom:1rem;
  }
  .emotion-cell {
    display:flex; flex-direction:column; align-items:center;
    padding:0.75rem; border:1px solid #ccc; border-radius:8px; cursor:pointer;
    transition:background .2s, border-color .2s;
  }
  .emotion-cell.selected {
    background:rgba(100,181,246,0.2); border-color:#64b5f6;
  }

  .diary-list button {
    display:block; width:100%; text-align:left; padding:0.5rem; margin-bottom:0.25rem;
    border:1px solid #ccc; background:#fff; cursor:pointer; border-radius:4px;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const studentId = localStorage.getItem('studentId');
  if (!studentId) return location.href='index.html';

  // ì˜¤ëŠ˜ ë‚ ì§œ
  const today = new Date().toISOString().split('T')[0];
  document.getElementById('attDate').innerText = today;

  // íƒ­ ì „í™˜
  document.querySelectorAll('.subtab').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.subtab').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      document.querySelectorAll('.subsection').forEach(sec=>sec.classList.remove('active'));
      document.getElementById(btn.dataset.target).classList.add('active');
    });
  });

  // ê°ì • ëª©ë¡
  const emotions = [
    {emoji:'ğŸ˜€',label:'ê¸°ì¨'},{emoji:'ğŸ˜„',label:'í–‰ë³µ'},{emoji:'ğŸ˜',label:'ì‚¬ë‘'},
    {emoji:'ğŸ˜Œ',label:'ì°¨ë¶„'},{emoji:'ğŸ˜‚',label:'ì¬ë¯¸'},{emoji:'ğŸ¤©',label:'ì„¤ë ˜'},
    {emoji:'ğŸ˜Š',label:'ë§Œì¡±'},{emoji:'ğŸ˜‰',label:'ì¥ë‚œ'},{emoji:'ğŸ˜œ',label:'ìœ ì¾Œ'},
    {emoji:'ğŸ˜',label:'í‰ë²”'},{emoji:'ğŸ˜',label:'ìŠ¬í””'},{emoji:'ğŸ˜­',label:'ëˆˆë¬¼'},
    {emoji:'ğŸ˜¡',label:'í™”ë‚¨'},{emoji:'ğŸ˜±',label:'ê³µí¬'},{emoji:'ğŸ˜´',label:'í”¼ê³¤'},
    {emoji:'ğŸ¤”',label:'ê³ ë¯¼'},{emoji:'ğŸ˜•',label:'í˜¼ë€'},{emoji:'ğŸ˜',label:'ìì‹ ê°'},
    {emoji:'ğŸ˜”',label:'ìš°ìš¸'},{emoji:'ğŸ˜“',label:'ìŠ¤íŠ¸ë ˆìŠ¤'},{emoji:'ğŸ˜‡',label:'ì•ˆë„'},
    {emoji:'ğŸ¤—',label:'ì¹œê·¼'},{emoji:'ğŸ¤’',label:'ì•„í””'},{emoji:'ğŸ˜¶',label:'ë¬´ê°ê°'},
    {emoji:'ğŸ™',label:'ê°ì‚¬'}
  ];

  // ì¶œì„ ê¸°ë¡ ë¡œë“œ
  function loadAttendance() {
    const list = document.getElementById('attendanceList');
    list.innerHTML = '';
    const prefix = `attendance_${studentId}_`;
    Object.keys(localStorage)
      .filter(key => key.startsWith(prefix))
      .sort()
      .forEach(key => {
        const { emoji, label, reason } = JSON.parse(localStorage.getItem(key));
        const date = key.replace(prefix, '');
        const li = document.createElement('li');
        li.style.padding = '0.4rem 0';
        li.innerText = `${date} â€“ ${emoji} ${label} â€“ ${reason}`;
        list.appendChild(li);
      });
    // TODO: ì„œë²„ ì—°ë™ ê°€ëŠ¥ ì§€ì 
  }

  // ê°ì • ê·¸ë¦¬ë“œ ìƒì„±
  const grid = document.querySelector('.emotion-grid');
  emotions.forEach(({emoji,label}) => {
    const cell = document.createElement('div');
    cell.className = 'emotion-cell';
    cell.innerHTML = `<div class="emo-emoji">${emoji}</div><div>${label}</div>`;
    grid.appendChild(cell);
    cell.addEventListener('click', () => {
      document.querySelectorAll('.emotion-cell').forEach(c=>c.classList.remove('selected'));
      cell.classList.add('selected');
      document.getElementById('attReason').style.display = 'block';
      document.getElementById('attReason').scrollIntoView({ behavior:'smooth' });
      // ê¸°ë³¸ ê°ì • ì €ì¥
      const key = `attendance_${studentId}_${today}`;
      localStorage.setItem(key, JSON.stringify({ emoji, label }));
    });
  });

  // ì¶œì„ ì²´í¬
  document.getElementById('checkBtn').addEventListener('click', () => {
    const sel = document.querySelector('.emotion-cell.selected');
    const reason = document.getElementById('reasonInput').value.trim();
    if (!sel) return alert('ê°ì •ì„ ì„ íƒí•˜ì„¸ìš”.');
    if (!reason) return alert('ì´ìœ ë¥¼ ì‘ì„±í•˜ì„¸ìš”.');
    const key = `attendance_${studentId}_${today}`;
    const base = JSON.parse(localStorage.getItem(key));
    localStorage.setItem(key, JSON.stringify({ ...base, reason }));
    alert('ì¶œì„ ì²´í¬ ì™„ë£Œ!');
    sel.classList.remove('selected');
    document.getElementById('reasonInput').value = '';
    document.getElementById('attReason').style.display = 'none';
    loadAttendance();
  });

  // ì¼ê¸° íƒ­ ë¡œì§
  const diaryList   = document.getElementById('diaryList');
  const diaryForm   = document.getElementById('diaryForm');
  const diaryView   = document.getElementById('diaryView');
  const newBtn      = document.getElementById('newDiaryBtn');
  const formDate    = document.getElementById('diaryDate');
  const formEmo     = document.getElementById('diaryEmotion');
  const formText    = document.getElementById('diaryText');
  const saveDiary   = document.getElementById('saveDiaryBtn');
  const backDiary   = document.getElementById('backDiaryBtn');

  // ê°ì • ì˜µì…˜ ì±„ìš°ê¸°
  emotions.forEach(({emoji,label}) => {
    const o = document.createElement('option');
    o.value = label;
    o.innerText = `${emoji} ${label}`;
    formEmo.appendChild(o);
  });

  function loadDiaryList() {
    diaryList.innerHTML = '';
    const prefix = `diary_${studentId}_`;
    Object.keys(localStorage)
      .filter(k => k.startsWith(prefix))
      .sort().reverse()
      .forEach(k => {
        const { date, emotion, text } = JSON.parse(localStorage.getItem(k));
        const btn = document.createElement('button');
        btn.innerText = `${date} â€“ ${text.slice(0,8)}...`;
        btn.addEventListener('click', () => viewEntry(k));
        diaryList.appendChild(btn);
      });
  }

  function viewEntry(key) {
    const data = JSON.parse(localStorage.getItem(key));
    diaryList.style.display = 'none';
    diaryForm.style.display = 'none';
    diaryView.style.display = 'block';
    document.getElementById('viewDate').innerText    = data.date;
    document.getElementById('viewEmotion').innerText = data.emotion;
    document.getElementById('viewOriginal').innerText= data.text;
    document.getElementById('viewAI').innerText       = data.aiSuggestion || 'ì—†ìŒ';
    document.getElementById('viewFinal').innerText    = data.finalContent || 'ì—†ìŒ';
  }

  newBtn.addEventListener('click', () => {
    diaryList.style.display = 'none';
    diaryView.style.display = 'none';
    diaryForm.style.display = 'block';
    formDate.value = today;
    const att = JSON.parse(localStorage.getItem(`attendance_${studentId}_${today}`) || '{}');
    formEmo.value = att.label || '';
    formText.value = '';
  });

  saveDiary.addEventListener('click', () => {
    const date    = formDate.value;
    const emotion = formEmo.value;
    const text    = formText.value.trim();
    if(!date||!emotion||!text) return alert('ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•˜ì„¸ìš”.');
    const key = `diary_${studentId}_${date}_${Date.now()}`;
    localStorage.setItem(key, JSON.stringify({
      date, emotion, text, aiSuggestion:'', finalContent:''
    }));
    alert('ì¼ê¸° ì €ì¥ ì™„ë£Œ!');
    diaryForm.style.display = 'none';
    loadDiaryList();
    diaryList.style.display = 'block';
  });

  backDiary.addEventListener('click', () => {
    diaryView.style.display = 'none';
    diaryForm.style.display = 'none';
    diaryList.style.display = 'block';
  });

  // ì´ˆê¸° ë¡œë“œ
  loadAttendance();
  loadDiaryList();
});
</script>




    <div id="learning" class="section">
      <h2>ë°°ì›€ ì •ë¦¬</h2>
      <p>ì—¬ê¸°ì— ìˆ˜ì—…ë³„ ë°°ì›€ ì •ë¦¬ í¼ì„ ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>
    <div id="footprint" class="section">
      <h2>ë‚˜ì˜ ë°œìêµ­</h2>
      <p>ì—¬ê¸°ì— ë‚˜ì˜ í•™ìŠµ í™œë™ ë¡œê·¸ë‚˜ ì‚¬ì§„ ë“±ì´ í‘œì‹œë©ë‹ˆë‹¤.</p>
    </div>
    <div id="teacher" class="section">
      <h2>ì„ ìƒë‹˜ì˜ ê¸°ë¡</h2>
      <p>ì„ ìƒë‹˜ì´ ì‘ì„±í•œ í”¼ë“œë°±ì´ë‚˜ ì½”ë©˜íŠ¸ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
    </div>
    <div id="growth" class="section">
      <h2>ì„±ì¥ ê¸°ë¡ì§€</h2>
      <p>ë¶„ê¸°ë³„ ì„±ì¥ ë³´ê³ ì„œ ë° ê·¸ë˜í”„ ë“±ì„ í‘œì‹œí•©ë‹ˆë‹¤.</p>
    </div>
  </div>

  <script>
    const links = document.querySelectorAll('nav a');
    const sections = document.querySelectorAll('.section');
    links.forEach(link => {
      link.addEventListener('click', () => {
        // ë©”ë‰´ active í† ê¸€
        links.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
        // ì„¹ì…˜ active í† ê¸€
        sections.forEach(s => s.classList.remove('active'));
        document.getElementById(link.dataset.target).classList.add('active');
      });
    });
  </script>

</body>
</html>
