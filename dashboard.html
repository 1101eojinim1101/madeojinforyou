<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>학생 대시보드</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      display: flex;
      height: 100vh;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    /* 사이드바 */
    nav {
      width: 180px;
      background: #b3e5fc;
      display: flex;
      flex-direction: column;
    }
    nav a {
      padding: 1rem;
      color: #333;
      text-decoration: none;
      cursor: pointer;
    }
    nav a:hover, nav a.active {
      background: #81d4fa;
    }
    /* 콘텐츠 영역 */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }
    .section {
      display: none;
    }
    .section.active {
      display: block;
    }
    h2 {
      margin-bottom: 1rem;
      color: #333;
    }
    p {
      line-height: 1.5;
    }
  </style>
</head>
<body>

  <!-- 좌측 메뉴 -->
  <nav id="sidebar">
    <a data-target="info"   class="active">나의 정보</a>
    <a data-target="secret">비밀 친구</a>
    <a data-target="learning">배움 정리</a>
    <a data-target="footprint">나의 발자국</a>
    <a data-target="teacher">선생님의 기록</a>
    <a data-target="growth">성장 기록지</a>
  </nav>

  <!-- 우측 콘텐츠 -->
   <!-- ====== 나의 정보 섹션 시작 ====== -->
<div id="info" class="section active">
  <h2>나의 정보</h2>

  <div id="infoForm" style="margin-top:2rem; max-width:400px;">
    <h3><span id="selectedName"></span>님의 정보</h3>

    <!-- 프로필 사진 업로드 & 미리보기 -->
    <div class="photo-container">
      <img id="profilePreview" alt="프로필 사진 미리보기" />
      <label for="photoUpload" class="photo-label">프로필 사진 선택</label>
      <input type="file" id="photoUpload" accept="image/png, image/jpeg" style="display:none" />
    </div>

    <!-- 정보 입력란 -->
    <input id="birthday"  type="date"     style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="mbti"      type="text"     placeholder="MBTI"                  style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="account"   type="text"     placeholder="수학탐험대 계정"        style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="accountPw" type="text"     placeholder="수학탐험대 비밀번호"    style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="hobby"     type="text"     placeholder="취미"                  style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="interest"  type="text"     placeholder="흥미"                  style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="skill"     type="text"     placeholder="특기"                  style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
    <input id="dream"     type="text"     placeholder="장래희망"              style="width:100%; margin-bottom:1rem; padding:0.5rem;" />

    <button id="saveInfo" style="width:100%; padding:0.75rem; background:#64b5f6; color:#fff; border:none; border-radius:6px; cursor:pointer;">
      저장하기
    </button>
  </div>
</div>
<!-- ====== 나의 정보 섹션 끝 ====== -->

<style>
  /* 프로필 사진 컨테이너 */
  .photo-container {
    position: relative;
    width: 120px;
    height: 120px;
    margin: 0 auto 1rem;
    border-radius: 50%;
    overflow: hidden;
    background: #f0f0f0;
    border: 1px solid #ccc;
  }
  .photo-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .photo-label {
    display: block;
    text-align: center;
    margin-top: 0.5rem;
    color: #007bff;
    cursor: pointer;
  }
</style>

<script>
  // 페이지 로드 시 로그인 확인 및 정보 로드
  document.addEventListener('DOMContentLoaded', () => {
    const studentId = localStorage.getItem('studentId');
    if (!studentId) return location.href = 'index.html';

    document.getElementById('selectedName').innerText = studentId;
    document.getElementById('infoForm').style.display = 'block';

    const data = JSON.parse(localStorage.getItem('info_' + studentId) || '{}');
    if (data.photo) document.getElementById('profilePreview').src = data.photo;
    ['birthday','mbti','account','accountPw','hobby','interest','skill','dream'].forEach(key => {
      if (data[key]) document.getElementById(key).value = data[key];
    });
  });

  // 사진 업로드 & 미리보기
  document.getElementById('photoUpload').addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = ev => document.getElementById('profilePreview').src = ev.target.result;
    reader.readAsDataURL(file);
  });

  // 정보 저장하기
  document.getElementById('saveInfo').addEventListener('click', () => {
    const studentId = localStorage.getItem('studentId');
    if (!studentId) return alert('로그인 후 이용하세요.');

    const obj = {
      photo: document.getElementById('profilePreview').src,
      birthday: document.getElementById('birthday').value,
      mbti: document.getElementById('mbti').value,
      account: document.getElementById('account').value,
      accountPw: document.getElementById('accountPw').value,
      hobby: document.getElementById('hobby').value,
      interest: document.getElementById('interest').value,
      skill: document.getElementById('skill').value,
      dream: document.getElementById('dream').value,
    };
    localStorage.setItem('info_' + studentId, JSON.stringify(obj));
    alert('나의 정보가 저장되었습니다.');
  });
</script>

  <div class="content">

<!-- ====== 비밀 친구 섹션 (secret) ====== -->
<div id="secret" class="section">
  <!-- 1) 최상단 서브탭 -->
  <div class="subtabs">
    <button class="subtab active" data-target="attendance">감정 출석부</button>
    <button class="subtab"       data-target="diary">일기 쓰기</button>
  </div>

  <div class="subcontent">
    <!-- 2) 감정 출석부 서브섹션 -->
    <div id="attendance" class="subsection active">
      <h3>감정 출석부 – <span id="attDate"></span></h3>
      <div class="emotion-grid"></div>

      <div id="attReason" class="attendance-reason" style="display:none;">
        <input id="reasonInput"
               type="text"
               maxlength="20"
               placeholder="20자 이내로 이유를 작성하세요"
               style="width:100%; margin-bottom:0.5rem; padding:0.5rem;" />
        <button id="checkBtn"
                style="padding:0.6em 1.2em; background:#64b5f6; color:#fff; border:none; border-radius:6px; cursor:pointer;">
          출석 체크
        </button>
      </div>
    </div>

    <!-- 3) 일기 쓰기 서브섹션 (추후 구현) -->
    <div id="diary" class="subsection">
      <h3>일기 쓰기</h3>
      <p>준비 중…</p>
    </div>
  </div>
</div>

<style>
  .subtabs {
    display: flex;
    border-bottom: 2px solid #ddd;
    margin-bottom: 1rem;
  }
  .subtabs .subtab {
    flex: 1;
    padding: 0.75rem;
    background: none;
    border: none;
    border-bottom: 3px solid transparent;
    font-size: 1rem;
    cursor: pointer;
  }
  .subtabs .subtab.active {
    border-color: #64b5f6;
    color: #64b5f6;
  }
  .subcontent .subsection {
    display: none;
  }
  .subcontent .subsection.active {
    display: block;
  }

  .emotion-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    grid-gap: 0.75rem;
  }
  .emotion-cell {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.75rem;
    border: 1px solid #ccc;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s, border-color 0.2s;
  }
  .emotion-cell.selected {
    background: rgba(100,181,246,0.2);
    border-color: #64b5f6;
  }
  .emotion-cell .emo-emoji {
    font-size: 1.5rem;
    margin-bottom: 0.25rem;
  }
  .attendance-reason {
    margin-top: 1rem;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // 날짜 표시
  const today = new Date().toISOString().split('T')[0];
  document.getElementById('attDate').innerText = today;

  // 탭 전환
  document.querySelectorAll('.subtab').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.subtab').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      document.querySelectorAll('.subsection').forEach(sec => sec.classList.remove('active'));
      document.getElementById(btn.dataset.target).classList.add('active');
    });
  });

  // 감정 목록 (25개)
  const emotions = [
    {emoji:'😀',label:'기쁨'},{emoji:'😄',label:'행복'},{emoji:'😍',label:'사랑'},
    {emoji:'😌',label:'차분'},{emoji:'😂',label:'재미'},{emoji:'🤩',label:'설렘'},
    {emoji:'😊',label:'만족'},{emoji:'😉',label:'장난'},{emoji:'😜',label:'유쾌'},
    {emoji:'😐',label:'평범'},{emoji:'😞',label:'슬픔'},{emoji:'😭',label:'눈물'},
    {emoji:'😡',label:'화남'},{emoji:'😱',label:'공포'},{emoji:'😴',label:'피곤'},
    {emoji:'🤔',label:'고민'},{emoji:'😕',label:'혼란'},{emoji:'😏',label:'자신감'},
    {emoji:'😔',label:'우울'},{emoji:'😓',label:'스트레스'},{emoji:'😇',label:'안도'},
    {emoji:'🤗',label:'친근'},{emoji:'🤒',label:'몸이 아픔'},{emoji:'😶',label:'무감각'},
    {emoji:'🙃',label:'장난'},{emoji:'🙏',label:'감사'}
  ];

  const grid = document.querySelector('.emotion-grid');
  emotions.forEach(({emoji,label}) => {
    const cell = document.createElement('div');
    cell.className = 'emotion-cell';
    cell.innerHTML = `<div class="emo-emoji">${emoji}</div><div>${label}</div>`;
    grid.appendChild(cell);
    cell.addEventListener('click', () => {
      document.querySelectorAll('.emotion-cell').forEach(c=>c.classList.remove('selected'));
      cell.classList.add('selected');
      document.getElementById('attReason').style.display = 'block';
      document.getElementById('attReason').scrollIntoView({ behavior:'smooth' });
    });
  });

  // 출석 체크
  document.getElementById('checkBtn').addEventListener('click', () => {
    const sel = document.querySelector('.emotion-cell.selected');
    const reason = document.getElementById('reasonInput').value.trim();
    if (!sel) return alert('감정을 선택하세요.');
    if (!reason) return alert('이유를 작성하세요.');
    // localStorage 저장 예시
    const key = `attendance_${localStorage.getItem('studentId')}_${today}`;
    localStorage.setItem(key, JSON.stringify({
      emoji: sel.querySelector('.emo-emoji').innerText,
      label: sel.innerText.replace(sel.querySelector('.emo-emoji').innerText,''),
      reason
    }));
    alert('출석 체크 완료!');
    // 리셋
    sel.classList.remove('selected');
    document.getElementById('reasonInput').value = '';
    document.getElementById('attReason').style.display = 'none';
  });
});
</script>


    <div id="learning" class="section">
      <h2>배움 정리</h2>
      <p>여기에 수업별 배움 정리 폼을 넣을 수 있습니다.</p>
    </div>
    <div id="footprint" class="section">
      <h2>나의 발자국</h2>
      <p>여기에 나의 학습 활동 로그나 사진 등이 표시됩니다.</p>
    </div>
    <div id="teacher" class="section">
      <h2>선생님의 기록</h2>
      <p>선생님이 작성한 피드백이나 코멘트를 보여줍니다.</p>
    </div>
    <div id="growth" class="section">
      <h2>성장 기록지</h2>
      <p>분기별 성장 보고서 및 그래프 등을 표시합니다.</p>
    </div>
  </div>

  <script>
    const links = document.querySelectorAll('nav a');
    const sections = document.querySelectorAll('.section');
    links.forEach(link => {
      link.addEventListener('click', () => {
        // 메뉴 active 토글
        links.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
        // 섹션 active 토글
        sections.forEach(s => s.classList.remove('active'));
        document.getElementById(link.dataset.target).classList.add('active');
      });
    });
  </script>

</body>
</html>
